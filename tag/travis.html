<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Tagged with "Travis" - Often Bearing Metaphoric Tense</title>
    <meta name="description" content="">
    <meta name="author" content="Abhishek L">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://theanalyst.github.io/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="https://fonts.googleapis.com/css?family=Gudea:400,400italic|Alegreya+SC" rel="stylesheet" type="text/css">
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap.no-icons.min.css" rel="stylesheet">
    <link href="http://theanalyst.github.io/theme/local.css" rel="stylesheet">
    <link href="http://theanalyst.github.io/theme/pygments.css" rel="stylesheet">
    <link href="http://theanalyst.github.io/theme/font-awesome.css" rel="stylesheet">
</head>

<body>
<header class="blog-header">
  <div class="container">
    <div class="row-fluid">
      <div class="span9">
	<a href="http://theanalyst.github.io" class="brand">Often Bearing Metaphoric Tense</a>
      </div>

      <div class="span3" id="blog-nav">
	<ul class="nav nav-pills pull-right">
            <li><a href="http://theanalyst.github.io/pages/about.html">About</a></li>
	    <li >
	      <a href="http://theanalyst.github.io/category/tech.html ">Tech</a>
	    <li >
	      <a href="http://theanalyst.github.io/category/rants.html ">Rants</a>
	</ul>
      </div>
    </div> <!-- End of fluid row-->
  </div>   <!-- End of Container-->
</header>
    
<div class="container">
    <div class="content">
    <div class="row-fluid">

        <div class="span10">
        

        

    <div class='row-fluid''>
        <div class="article-title span9">
            <a href="http://theanalyst.github.io/faster-python-builds-in-travis-with-container-based-infra.html"><h1>Faster python builds in Travis with container based infra</h1></a>
        </div>
    </div>
    <div class="row-fluid">
      <div class="span2">
<p>01 Feb 2015 </p>

<p style="text-align: left;">
Filed under <a href="http://theanalyst.github.io/category/tech.html">Tech</a>
</p>
<p style="text-align: left;">
 
    Tags <a href="http://theanalyst.github.io/tag/python.html">Python</a> <a href="http://theanalyst.github.io/tag/travis.html">Travis</a> </p>
<p>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="abhishekl">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
</p>
      </div>
      <div class="article-content span8">
	<p>Lately, travis CI has started supporting builds using <a href="http://blog.travis-ci.com/2014-12-17-faster-builds-with-container-based-infrastructure/">container</a>
based infrastructure which run much faster due to more available
resources and good use of caching. This is currently possible only for
projects that don't use <code>sudo</code> atm . For more details read <a href="http://docs.travis-ci.com/user/workers/container-based-infrastructure/">this</a>
post. Of late, I have been submitting Pull Requests to various
projects to use this feature wherever possible. This post is primarily
oriented towards Python projects.</p>
<p>For many python projects, a significant amount of time is spent in
installing &amp; building the dependencies. So caching these should save
you a good amount of time. Pip downloads can be cached specifying a
cache directory, which will avoid hitting the pypi mirror for every
line in your requirements. The below examples assume that your testing
script is something like <code>make travis</code></p>
<div class="highlight"><pre><span class="l-Scalar-Plain">sudo</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>
<span class="l-Scalar-Plain">cache</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">directories</span><span class="p-Indicator">:</span> 
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">$HOME/.pip-cache</span>
<span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pip install -r requirements.txt --download-cache $HOME/.pip-cache</span>   
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">make travis</span>
</pre></div>


<p>The above lines will make sure that for subsequent runs pip packages
from the cache are used. However the packages will still need to be be
built, which means if you're using packages using C (lxml for eg), a
lot of time will be still spent for building the package itself. One
way of working around this would be the use of Python Wheels and
caching them as this avoids the need for subsequent builds. We could
download the wheels to a specified directory and cache that, so that
we can cut down on the build time.  So we would have something like:</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">sudo</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>
<span class="l-Scalar-Plain">cache</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">directories</span><span class="p-Indicator">:</span> 
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">$PWD/wheelhouse</span>
<span class="l-Scalar-Plain">script</span><span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pip wheel -r requirements.txt</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pip install -r requirements.txt</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">make travis</span>
</pre></div>


<p>And voila! We have faster travis builds.</p>
<p>PS If you have better ways to speedup, I'll be happy to hear, please
let me know in comments or hit me up on <a href="https://twitter.com/abhishekl">twitter</a>.</p> 
	<a class="btn btn-mini xsmall" href="http://theanalyst.github.io/faster-python-builds-in-travis-with-container-based-infra.html">
          <i class="icon-comment"></i> Comment </a>
	<hr />
      </div>
      
    </div>
    
<div class="pagination">
<ul>
    <li class="prev disabled"><a href="#">&larr; Previous</a></li>

    <li class="active"><a href="http://theanalyst.github.io/tag/travis.html">1</a></li>

    <li class="next disabled"><a href="#">&rarr; Next</a></li>

</ul>
</div>
 
  
        </div>
        
        
    </div>     </div> </div>

<!--footer-->
<div class="container">
  <div class="well" style="background-color: #E9EFF6">
    <div id="blog-footer">
      <div class="row-fluid">
	<div class="social span2" align="center" id="socialist">
	  <ul class="nav nav-list">
	    <li class="nav-header">
	      Social
	    </li>
	    <li><a href="http://twitter.com/abhishekl"><i class="icon-twitter" style="color: #1f334b"></i>twitter</a></li>
	    <li><a href="http://github.com/theanalyst"><i class="icon-github" style="color: #1f334b"></i>github</a></li>
	    <li><a href="http://theanalystquotes.blogspot.com"><i class="icon-blogger" style="color: #1f334b"></i>blogger</a></li>
            <a href="mailto:abhishekl.2006@gmail.com"><i class="icon-envelope" style="color: #1f334b" ></i> email</a>

	  </ul>
	</div>
<div class="span8" id="colophon">
  <h2 align="center">Colophon</h2>
  <p align="justify"> 
 Hello there, thanks for the interest to scroll all the way down
 This is a blog for random things that I find
 interesting. There are two broad categories here, possibly non
 intersecting sections of posts here. Also, Often Bearing Metaphoric
 Tense anagrams to the "Importance of Being Earnest", Algernon is unavailable
 for comment  </p>
</div>
	<div class="site-nav span2" align="center">
          <ul class="nav nav-list" id="site-links">
            <li class="nav-header"> 
              Site
            </li>
            <li><a href="http://theanalyst.github.io"><i class="icon-home" style="color: #1f334b">
                </i>Home</a></li>
            <li><a href="http://theanalyst.github.io/archives.html"><i class="icon-list" style="color: #1f334b">
                </i>Archives</a></li>
	    <li><a href="http://theanalyst.github.io/tags.html"><i class="icon-tags" style="color: #1f334b">
                </i>Tags</a></li>
	    
	    <li> <a href="http://theanalyst.github.io/feeds/all.rss.xml" rel="alternate">
                <i class="icon-rss" style="color: #1f334b"></i>
                RSS Feed</a></li>
            <li><a href="http://theanalyst.github.io/" rel="alternate">
                <i class="icon-rss-sign" style="color: #1f334b"></i>
                Atom Feed</a></li>
	  </ul>

        </div>

      </div> <!--end of fluid row-->
    </div> <!--end of blog-footer-->
    <hr />
    <p align="center"><a href="http://theanalyst.github.io">Often Bearing Metaphoric Tense</a>
      &copy; Abhishek L
    Powered by <a href="https://github.com/getpelican/pelican">Pelican</a> and
        <a href="https://twitter.github.com/bootstrap">Twitter Bootstrap</a>. 
        Icons by <a href="http://fortawesome.github.com/Font-Awesome">Font Awesome</a> and 
        <a href="http://gregoryloucas.github.com/Font-Awesome-More">Font Awesome More</a></p>

  </div> <!--end of well -->
</div> <!--end of container -->

<!--/footer-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>



</body>
</html>